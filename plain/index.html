<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OldMartijntje.nl</title>
    <link rel="icon" href="https://i.imgur.com/vQRiN5j.png" type="image/x-icon">
    <meta name="keywords" content="oldmartijntje portofolio website">
    <meta name="author" content="OldMartijntje">
    <meta property="og:title" content="OldMartijntje.nl">
    <meta property="og:description" content="OldMartijntje's personal WebcornerðŸ’º">
    <meta property="og:image" content="https://oldmartijntje.nl/assets/images/mii.png">
    <meta property="og:url" content="https://oldmartijntje.nl">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="OldMartijntje.nl">

    <link rel="stylesheet" href="main.css">

</head>

<body>
    <button id="sidebarToggle" class="sidebar-toggle">â˜°</button>
    <div id="sidebar" class="sidebar">
        <div class="sidebar-content">
            <h2>Menu</h2>
            <ul>
                <li><a href="#" target="_blank">Homepage</a></li>
                <li><a href="https://github.com/oldmartijntje" target="_blank">Github</a></li>
            </ul>
        </div>
    </div>

    <header class="header">
        <div class="header-content">
            <h1>OldMartijntje</h1>
            <p>Software Developer</p>
        </div>
    </header>

    <main>
        <h2>My Projects</h2>
        <div class="projects-container">
            <div id="projects" class="projects"></div>
            <div id="scrollIndicatorLeft" class="scroll-indicator scroll-indicator-left">&lt;</div>
            <div id="scrollIndicatorRight" class="scroll-indicator scroll-indicator-right">&gt;</div>
        </div>
    </main>

    <div id="overlay" class="overlay">
        <div class="overlay-content">
            <button class="close-btn">&times;</button>
            <div id="overlay-info"></div>
        </div>
    </div>

    <script>
        const response = fetch('https://api.oldmartijntje.nl/getData/projects', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                // Include any data you want to send with the POST request here
            })
        }).then(response => response.json()).then(data => {
            const projectsContainer = document.getElementById('projects');
            const projectsContainerEl = document.querySelector('.projects-container');
            const overlay = document.getElementById('overlay');
            const overlayInfo = document.getElementById('overlay-info');
            const closeBtn = document.querySelector('.close-btn');
            const scrollIndicatorLeft = document.getElementById('scrollIndicatorLeft');
            const scrollIndicatorRight = document.getElementById('scrollIndicatorRight');

            data['projects'].sort((a, b) => new Date(b.lastUpdated) - new Date(a.lastUpdated));
            console.log(data['projects']);

            data['projects'].forEach(project => {
                const projectDiv = document.createElement('div');
                projectDiv.classList.add('project');
                projectDiv.innerHTML = `
                ${project.link ? `<a href="${project.link}" target="_blank">` : ''}
                    <img src="${project.images[project.tumbnailImageId]}" alt="${project.title}">
                ${project.link ? `</a>` : ''}
                
                <div class="project-content">
                    <h3 class="project-title">${project.title}</h3>
                    <button class="info-btn" data-lastUpdated="${encodeURIComponent(project.lastUpdated)}" data-info="${encodeURIComponent(project.info)}" data-link="${encodeURIComponent(project.link)}" data-title=${encodeURIComponent(project.title)}>More Info</button>
                </div>
            `;
                projectsContainer.appendChild(projectDiv);
            });

            projectsContainerEl.addEventListener('scroll', () => {
                updateScrollIndicators(projectsContainerEl)
            });

            scrollIndicatorLeft.addEventListener('click', () => {
                projectsContainerEl.scrollBy({ left: -projectsContainerEl.clientWidth, behavior: 'smooth' });
            });

            scrollIndicatorRight.addEventListener('click', () => {
                projectsContainerEl.scrollBy({ left: projectsContainerEl.clientWidth, behavior: 'smooth' });
            });

            projectsContainer.addEventListener('click', function (e) {
                if (e.target.classList.contains('info-btn')) {
                    const info = decodeURIComponent(e.target.dataset.info);
                    const link = decodeURIComponent(e.target.dataset.link);
                    const title = decodeURIComponent(e.target.dataset.title);
                    const lastUpdated = decodeURIComponent(e.target.dataset.lastupdated);
                    if (!link || link == '' || link == 'undefined') {
                        overlayInfo.innerHTML = `<h2>${title}</h2>`;
                    } else {
                        overlayInfo.innerHTML = `<a href="${link}" target="_blank"><h2>${title}</h2></a>`;
                    }
                    overlayInfo.innerHTML += info;

                    if (link && link !== '' && link !== 'undefined') {
                        overlayInfo.innerHTML += `<p>Click <a href="${link}" target="_blank">Here</a> to view the project.</p>`;
                    }
                    if (lastUpdated && lastUpdated !== '' && lastUpdated !== 'undefined') {
                        const date = new Date(lastUpdated);
                        const day = String(date.getDate()).padStart(2, '0');
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const year = date.getFullYear();
                        overlayInfo.innerHTML += `<sub><strong>${day}-${month}-${year}</strong></sub>`;
                    }

                    overlay.style.display = 'block';
                }
            });

            closeBtn.addEventListener('click', function () {
                overlay.style.display = 'none';
            });

            window.addEventListener('click', function (e) {
                if (e.target === overlay) {
                    overlay.style.display = 'none';
                }
            });

            updateScrollIndicators(projectsContainerEl);
        });

        function updateScrollIndicators(projectsContainerEl) {
            const scrollLeft = projectsContainerEl.scrollLeft;
            const maxScrollLeft = projectsContainerEl.scrollWidth - projectsContainerEl.clientWidth;

            if (scrollLeft > 20) {
                scrollIndicatorLeft.classList.add('visible');
            } else {
                scrollIndicatorLeft.classList.remove('visible');
            }

            if ((projectsContainerEl.scrollWidth - projectsContainerEl.clientWidth) - scrollLeft > 20) {
                scrollIndicatorRight.classList.add('visible');
            } else {
                scrollIndicatorRight.classList.remove('visible');
            }
        }

        // Sidebar functionality
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');

        sidebarToggle.addEventListener('click', function () {
            sidebar.classList.toggle('open');
        });

        // Close sidebar when clicking outside of it
        document.addEventListener('click', function (event) {
            if (!sidebar.contains(event.target) && !sidebarToggle.contains(event.target)) {
                sidebar.classList.remove('open');
            }
        });
    </script>
</body>

</html>